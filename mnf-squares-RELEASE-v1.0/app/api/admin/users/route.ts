import { NextResponse } from 'next/server'; import { PrismaClient } from '@prisma/client'; import { requireRole } from '@/app/lib/requireRole'; const prisma=new PrismaClient(); export async function GET(req:Request){ const f=await requireRole('ADMIN',req); if(f) return f; return NextResponse.json(await prisma.user.findMany({ orderBy:{ createdAt:'desc' } })); } export async function POST(req:Request){ const f=await requireRole('ADMIN',req); if(f) return f; const b=await req.json(); const u=await prisma.user.create({ data:{ email:b.email, name:b.name||null, role:b.role||'VIEWER' } }); return NextResponse.json(u); }